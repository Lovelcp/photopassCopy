package com.pictureair.photopass.widget;import android.content.Context;import android.graphics.Color;import android.view.Gravity;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup.LayoutParams;import android.widget.ImageView;import android.widget.PopupWindow;import android.widget.TextView;import com.pictureair.photopass.R;import com.pictureair.photopass.util.PictureAirLog;import com.pictureair.photopass.util.ScreenUtil;public class CustomProgressBarPop {	private Context context;	private ImageView imageView;	private TextView textView;	private LayoutInflater inflater;	private View defaultView;	private PopupWindow popupWindow;	private View parentView;	private int showType = 0;// 0-加载 ；1-上传； ；2- 删除 ；3-下载	public static final int TYPE_LOADING = 0;	public static final int TYPE_UPLOAD = 1;	public static final int TYPE_DELETE = 2;	public static final int TYPE_DOWNLOAD = 3;	/**	 * 初始化	 * 	 * @param context	 * @param parentView 父控件 删除文件操作	 */	public CustomProgressBarPop(Context context, View parentView, int type) {		this.context = context;		this.parentView = parentView;		this.showType = type;		initPopupWindow();	}	private void initPopupWindow() {		inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);		defaultView = inflater.inflate(R.layout.customprogressdialog, null);		popupWindow = new PopupWindow(defaultView, LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);		popupWindow.setFocusable(true);		imageView = (ImageView) defaultView.findViewById(R.id.loadingImageView);		textView = (TextView) defaultView.findViewById(R.id.id_tv_loadingmsg);		LayoutParams params = imageView.getLayoutParams();		params.width = ScreenUtil.getScreenWidth(context) / 6;		params.height = params.width;		imageView.setBackgroundColor(Color.TRANSPARENT);	}	/**	 * 显示对话框	 * 	 * @param totalCount 删除文件的文件数量，如果是上传下载图片操作，可以传0	 */	public void show(int totalCount) {		popupWindow.showAtLocation(parentView, Gravity.CENTER, 0, 0);		imageView.setImageResource(R.drawable.loading_0);		setText(0, totalCount);	}	/**	 * 根据类型返回内容 0-加载 ；1-上传； ；2- 删除 ；3-下载	 * 	 * @param progress	 * @param totalCount	 */	public void setText(long progress, long totalCount) {		String showText;		switch (showType) {		case TYPE_UPLOAD:			// 上传			if (progress > 0 && totalCount > 0) {				showText = String.format(context.getString(R.string.loading_percent), progress * 100 / totalCount) + "%";			} else {				showText = String.format(context.getString(R.string.loading_percent), 0) + "%";			}			break;		case TYPE_DELETE:			// 删除			showText = String.format(context.getString(R.string.delete_percent), progress, totalCount);			break;		case TYPE_DOWNLOAD:			// 下载			if (progress > 0 && totalCount > 0) {				showText = String.format(context.getString(R.string.downloading_percent), progress * 100 / totalCount) + "%";			} else {				showText = String.format(context.getString(R.string.downloading_percent), 0) + "%";			}			break;		default:			// 加载 TYPE_LOADING			showText = String.format(context.getString(R.string.loading_percent), 0) + "%";			break;		}		textView.setText(showText + "");	}	public void dismiss() {		if (popupWindow != null) {			popupWindow.dismiss();		}	}	public boolean isShowing() {		return popupWindow.isShowing();	}	/**	 * 更新进度条	 * 	 * @param progress	 */	public void setProgress(long progress, long total) {		PictureAirLog.out("--------->"+ progress);		long currentProgress = progress * 100 / total;		int result = R.drawable.loading_0;		if (currentProgress >= 0 && currentProgress <= 8) {			result = R.drawable.loading_0;		} else if (currentProgress > 8 && currentProgress <= 16) {			result = R.drawable.loading_1;		} else if (currentProgress > 16 && currentProgress <= 25) {			result = R.drawable.loading_2;		} else if (currentProgress > 25 && currentProgress <= 33) {			result = R.drawable.loading_3;		} else if (currentProgress > 33 && currentProgress <= 41) {			result = R.drawable.loading_4;		} else if (currentProgress > 41 && currentProgress <= 50) {			result = R.drawable.loading_5;		} else if (currentProgress > 50 && currentProgress <= 58) {			result = R.drawable.loading_6;		} else if (currentProgress > 58 && currentProgress <= 66) {			result = R.drawable.loading_7;		} else if (currentProgress > 66 && currentProgress <= 75) {			result = R.drawable.loading_8;		} else if (currentProgress > 75 && currentProgress <= 83) {			result = R.drawable.loading_9;		} else if (currentProgress > 83 && currentProgress <= 91) {			result = R.drawable.loading_10;		} else if (currentProgress > 91 && currentProgress < 100) {			result = R.drawable.loading_11;		} else {			result = R.drawable.loading_12;		}		imageView.setImageResource(result);		setText(progress, total);	}}